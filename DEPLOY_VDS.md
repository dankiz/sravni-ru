# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é –Ω–∞ VDS —Å–µ—Ä–≤–µ—Ä (RUVDS)

## –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–µ—Ä–µ:
- **IP:** 195.58.51.50
- **–û–°:** Debian 11
- **RAM:** 0.5GB (–º–∞–ª–æ –¥–ª—è PostgreSQL, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤–Ω–µ—à–Ω—é—é –ë–î)
- **–î–∏—Å–∫:** 10GB

## –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

### Windows (PowerShell –∏–ª–∏ CMD):
```bash
ssh root@195.58.51.50
```

### –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ PuTTY:
- Host: 195.58.51.50
- Port: 22
- Username: root
- Password: (–≤–∞—à –ø–∞—Ä–æ–ª—å)

–ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤—ã —É–≤–∏–¥–∏—Ç–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏.

---

## –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
apt update
apt upgrade -y
```

---

## –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js 20.x

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js —á–µ—Ä–µ–∑ NodeSource
curl -fsSL https://deb.nodesource.com/setup_20.x | bash -
apt install -y nodejs

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
node --version  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å v20.x.x
npm --version
```

---

## –®–∞–≥ 4: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git

```bash
apt install -y git
```

---

## –®–∞–≥ 5: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ PM2 (–º–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ—Ü–µ—Å—Å–æ–≤)

```bash
npm install -g pm2
```

---

## –®–∞–≥ 6: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Nginx (–æ–±—Ä–∞—Ç–Ω—ã–π –ø—Ä–æ–∫—Å–∏)

```bash
apt install -y nginx
systemctl start nginx
systemctl enable nginx
```

---

## –®–∞–≥ 7: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–í–ê–ñ–ù–û:** –ù–∞ –≤–∞—à–µ–º —Å–µ—Ä–≤–µ—Ä–µ –≤—Å–µ–≥–æ 0.5GB RAM, —á—Ç–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è PostgreSQL. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å:

### –í–∞—Ä–∏–∞–Ω—Ç A: Neon.tech (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, —Ä–µ–∫–æ–º–µ–Ω–¥—É—é)
1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://neon.tech
2. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å
3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `DATABASE_URL` (–±—É–¥–µ—Ç –Ω—É–∂–µ–Ω –ø–æ–∑–∂–µ)

### –í–∞—Ä–∏–∞–Ω—Ç B: Supabase (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
1. –ó–∞–π–¥–∏—Ç–µ –Ω–∞ https://supabase.com
2. –°–æ–∑–¥–∞–π—Ç–µ –ø—Ä–æ–µ–∫—Ç
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ `DATABASE_URL`

---

## –®–∞–≥ 8: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
cd /var/www

# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à URL)
# –ï—Å–ª–∏ –∫–æ–¥ –≤ GitHub:
git clone https://github.com/–≤–∞—à-username/–≤–∞—à-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.git sravni-ru

# –ò–ª–∏ –µ—Å–ª–∏ –∫–æ–¥ –ª–æ–∫–∞–ª—å–Ω–æ, –∑–∞–≥—Ä—É–∑–∏—Ç–µ —á–µ—Ä–µ–∑ SCP:
# –ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:
# scp -r C:\Users\Daniil\Desktop\–°–∫—Ä–∏–ø—Ç—ã\Skysmart\sravni.ru root@195.58.51.50:/var/www/sravni-ru

cd sravni-ru
```

---

## –®–∞–≥ 9: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
npm install
```

---

## –®–∞–≥ 10: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª .env
nano .env
```

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ (–∑–∞–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å–≤–æ–∏):

```env
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–∏–∑ Neon –∏–ª–∏ Supabase)
DATABASE_URL=postgresql://user:password@host:5432/database?sslmode=require

# NextAuth
NEXTAUTH_URL=http://195.58.51.50
NEXTAUTH_SECRET=—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ-—Å–µ–∫—Ä–µ—Ç–Ω—ã–π-–∫–ª—é—á-–∑–¥–µ—Å—å

# –û–∫—Ä—É–∂–µ–Ω–∏–µ
NODE_ENV=production
NEXT_PUBLIC_APP_URL=http://195.58.51.50

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
REDIRECT_DOMAIN=https://go.acstat.com/fce64814c5585361
NEXT_PUBLIC_REDIRECT_DOMAIN=https://go.acstat.com/fce64814c5585361
```

**–î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ NEXTAUTH_SECRET:**
```bash
openssl rand -base64 32
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ñ–∞–π–ª: `Ctrl+O`, `Enter`, `Ctrl+X`

---

## –®–∞–≥ 11: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma –∫–ª–∏–µ–Ω—Ç–∞ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏

```bash
# –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º Prisma –∫–ª–∏–µ–Ω—Ç
npx prisma generate

# –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
npx prisma migrate deploy
# –∏–ª–∏ –µ—Å–ª–∏ –º–∏–≥—Ä–∞—Ü–∏–π –Ω–µ—Ç:
npx prisma db push
```

---

## –®–∞–≥ 12: –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
npm run build
```

–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç.

---

## –®–∞–≥ 13: –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–æ–∫

```bash
mkdir -p public/uploads/courses
chmod -R 755 public/uploads
```

---

## –®–∞–≥ 14: –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ PM2

```bash
# –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
pm2 start npm --name "sravni-ru" -- start

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PM2
pm2 save

# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞
pm2 startup
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä—É—é –≤—ã–≤–µ–¥–µ—Ç PM2 (–æ–±—ã—á–Ω–æ —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ: sudo env PATH=...)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
pm2 status
pm2 logs sravni-ru
```

---

## –®–∞–≥ 15: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

```bash
# –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nano /etc/nginx/sites-available/sravni-ru
```

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–µ–µ:

```nginx
server {
    listen 80;
    server_name 195.58.51.50;

    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤ (–¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
    client_max_body_size 10M;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ: `Ctrl+O`, `Enter`, `Ctrl+X`

```bash
# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
ln -s /etc/nginx/sites-available/sravni-ru /etc/nginx/sites-enabled/

# –£–¥–∞–ª—è–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
rm /etc/nginx/sites-enabled/default

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
nginx -t

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º Nginx
systemctl restart nginx
```

---

## –®–∞–≥ 16: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Firewall

```bash
# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º UFW (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
apt install -y ufw

# –†–∞–∑—Ä–µ—à–∞–µ–º SSH (–≤–∞–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–µ—Ä–≤—ã–º!)
ufw allow 22/tcp

# –†–∞–∑—Ä–µ—à–∞–µ–º HTTP
ufw allow 80/tcp

# –†–∞–∑—Ä–µ—à–∞–µ–º HTTPS (–Ω–∞ –±—É–¥—É—â–µ–µ)
ufw allow 443/tcp

# –í–∫–ª—é—á–∞–µ–º firewall
ufw enable

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
ufw status
```

---

## –®–∞–≥ 17: –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
cd /var/www/sravni-ru
npm run create-admin
# –∏–ª–∏
npm run init-admin
```

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–º–∏–Ω-–∞–∫–∫–∞—É–Ω—Ç–∞.

---

## –®–∞–≥ 18: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://195.58.51.50
```

–°–∞–π—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å—Å—è!

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

### PM2 –∫–æ–º–∞–Ω–¥—ã:
```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞
pm2 status

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
pm2 logs sravni-ru

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
pm2 restart sravni-ru

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
pm2 stop sravni-ru

# –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ PM2
pm2 delete sravni-ru
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞:
```bash
cd /var/www/sravni-ru

# –ï—Å–ª–∏ –∫–æ–¥ –≤ Git:
git pull origin main

# –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm install

# –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ–º
npm run build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º
pm2 restart sravni-ru
```

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ Nginx:
```bash
tail -f /var/log/nginx/error.log
tail -f /var/log/nginx/access.log
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–æ–≤:
```bash
netstat -tulpn | grep :3000
netstat -tulpn | grep :80
```

---

## Troubleshooting:

### –°–∞–π—Ç –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ: `pm2 status`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs sravni-ru`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Nginx: `systemctl status nginx`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall: `ufw status`
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—Ç: `netstat -tulpn | grep :3000`

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DATABASE_URL –≤ `.env`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ë–î –¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs sravni-ru`

### –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –ø–∞–º—è—Ç–∏:
- –£ –≤–∞—Å –≤—Å–µ–≥–æ 0.5GB RAM
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤–Ω–µ—à–Ω—é—é –ë–î (Neon/Supabase)
- –ù–µ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ PostgreSQL –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ —Ä–µ—Å—É—Ä—Å–æ–≤, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∞–ø–≥—Ä–µ–π–¥ —Å–µ—Ä–≤–µ—Ä–∞

### –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ:
```bash
# –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à
rm -rf .next
rm -rf node_modules
npm install
npm run build
```

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–∞–ª–æ–≥–æ –æ–±—ä–µ–º–∞ RAM:

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Node.js:
```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ .env –∏–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ PM2:
NODE_OPTIONS=--max-old-space-size=400
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–∞–º—è—Ç–∏:
```bash
free -h
htop  # –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω: apt install htop
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

1. **–ò–∑–º–µ–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª—å root:**
```bash
passwd
```

2. **–°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):**
```bash
adduser deploy
usermod -aG sudo deploy
```

3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSH –∫–ª—é—á–∏ (–≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª—è):**
```bash
# –ù–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ —Å–æ–∑–¥–∞–π—Ç–µ –∫–ª—é—á –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
```

---

## –ì–æ—Ç–æ–≤–æ! üéâ

–í–∞—à —Å–∞–π—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: **http://195.58.51.50**

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ —Ä–∞–∑–¥–µ–ª–µ Troubleshooting.

